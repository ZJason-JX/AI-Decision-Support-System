import { AlertTriangle, TrendingUp, Lightbulb, CheckCircle, BarChart3, ArrowRight, Camera } from 'lucide-react';
import { useState } from 'react';

export default function App() {
  const [screenshotMode, setScreenshotMode] = useState(false);

  const handleScreenshotMode = () => {
    setScreenshotMode(true);
    // Scroll to top to show full content
    window.scrollTo({ top: 0, behavior: 'smooth' });
    
    // Show instructions
    setTimeout(() => {
      const isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;
      const instructions = isMac 
        ? 'æŒ‰ Cmd + Shift + 4 è¿›è¡Œæˆªå›¾ï¼Œæ‹–åŠ¨é€‰æ‹©æ•´ä¸ªå†…å®¹åŒºåŸŸ'
        : 'æŒ‰ Win + Shift + S è¿›è¡Œæˆªå›¾ï¼Œé€‰æ‹©çŸ©å½¢åŒºåŸŸæˆªå–æ•´ä¸ªå†…å®¹';
      alert(instructions);
    }, 500);
  };

  const exitScreenshotMode = () => {
    setScreenshotMode(false);
  };

  return (
    <div className={`min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 ${screenshotMode ? 'p-2' : 'p-8'}`}>
      <div className={`mx-auto ${screenshotMode ? 'max-w-6xl' : 'max-w-7xl'}`}>
        {/* Screenshot Mode Button */}
        {!screenshotMode && (
          <div className="flex justify-end mb-4">
            <button
              onClick={handleScreenshotMode}
              className="flex items-center gap-2 bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-800 transition-colors shadow-lg"
            >
              <Camera className="w-4 h-4" />
              å‡†å¤‡æˆªå›¾æ¨¡å¼
            </button>
          </div>
        )}

        {/* Exit Screenshot Mode */}
        {screenshotMode && (
          <div className="flex justify-center mb-1">
            <button
              onClick={exitScreenshotMode}
              className="text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700 transition-colors"
            >
              é€€å‡ºæˆªå›¾æ¨¡å¼
            </button>
          </div>
        )}

        {/* Workflow Content */}
        <div className={screenshotMode ? 'screenshot-mode' : ''} style={screenshotMode ? { transform: 'scale(0.67)', transformOrigin: 'top center' } : {}}>
          {/* Header */}
          <div className={`text-center ${screenshotMode ? 'mb-2' : 'mb-12'}`}>
            <h1 className={`font-bold text-slate-900 ${screenshotMode ? 'text-xl mb-1' : 'text-4xl mb-2'}`}>
              AI-Assisted Decision Workflow (Human-in-the-loop)
            </h1>
            <p className={`text-slate-600 ${screenshotMode ? 'text-xs' : ''}`}>äººæœºåä½œå†³ç­–æµç¨‹</p>
          </div>

          {/* Workflow Container */}
          <div className="relative">
            {/* Connection Lines */}
            <div 
              className="absolute top-24 left-0 right-0 h-1 bg-gradient-to-r from-red-200 via-blue-200 to-green-200 hidden lg:block" 
              style={{ top: screenshotMode ? '50px' : '120px' }} 
            />

            {/* Workflow Nodes */}
            <div className={`grid grid-cols-1 lg:grid-cols-5 ${screenshotMode ? 'gap-1.5' : 'gap-6'} relative`}>
              {/* Node 1: Risk Signal */}
              <WorkflowNode
                icon={<AlertTriangle className="w-8 h-8" />}
                iconColor="text-red-600"
                bgColor="bg-red-50"
                borderColor="border-red-200"
                number="1"
                title="Risk Signal Triggered"
                titleCn="é£é™©ä¿¡å·è§¦å‘"
                description="External data or system signals indicate elevated risk"
                descriptionCn="å¤–éƒ¨æ•°æ®æˆ–ç³»ç»Ÿä¿¡å·è¡¨æ˜é£é™©å‡é«˜"
                details="(e.g. weather, system metrics, anomaly detection)"
                detailsCn="ï¼ˆä¾‹å¦‚ï¼šå¤©æ°”ã€ç³»ç»ŸæŒ‡æ ‡ã€å¼‚å¸¸æ£€æµ‹ï¼‰"
              />

              <ArrowConnector />

              {/* Node 2: Risk Overview */}
              <WorkflowNode
                icon={<TrendingUp className="w-8 h-8" />}
                iconColor="text-orange-600"
                bgColor="bg-orange-50"
                borderColor="border-orange-200"
                number="2"
                title="Risk Overview"
                titleCn="é£é™©æ¦‚è§ˆ"
                description="â€¢ Risk level & trend"
                descriptionCn="â€¢ é£é™©ç­‰çº§ä¸è¶‹åŠ¿"
                details="â€¢ Key contributing factors"
                detailsCn="â€¢ å…³é”®å½±å“å› ç´ "
                extraDetails="â€¢ AI confidence & explanation"
                extraDetailsCn="â€¢ AI ç½®ä¿¡åº¦ä¸è§£é‡Š"
                designNote="Designed for fast situational awareness under time pressure."
                designNoteCn="ä¸ºæ—¶é—´å‹åŠ›ä¸‹çš„å¿«é€Ÿæ€åŠ¿æ„ŸçŸ¥è€Œè®¾è®¡"
              />

              <ArrowConnector />

              {/* Node 3: AI Recommendation */}
              <WorkflowNode
                icon={<Lightbulb className="w-8 h-8" />}
                iconColor="text-blue-600"
                bgColor="bg-blue-50"
                borderColor="border-blue-200"
                number="3"
                title="AI-Generated Recommendations"
                titleCn="AI ç”Ÿæˆå»ºè®®"
                description="â€¢ Option A / B / C"
                descriptionCn="â€¢ æ–¹æ¡ˆ A / B / C"
                details="â€¢ Expected outcome"
                detailsCn="â€¢ é¢„æœŸç»“æœ"
                extraDetails="â€¢ Risk & uncertainty"
                extraDetailsCn="â€¢ é£é™©ä¸ä¸ç¡®å®šæ€§"
                designNote="AI provides options, not decisions."
                designNoteCn="AI æä¾›é€‰é¡¹ï¼Œè€Œéå†³ç­–"
                isImportant={true}
              />

              <ArrowConnector />

              {/* Node 4: Human Decision */}
              <WorkflowNode
                icon={<CheckCircle className="w-8 h-8" />}
                iconColor="text-purple-600"
                bgColor="bg-purple-50"
                borderColor="border-purple-200"
                number="4"
                title="Human Confirmation & Decision"
                titleCn="äººç±»ç¡®è®¤ä¸å†³ç­–"
                description="â€¢ Accept / modify AI suggestion"
                descriptionCn="â€¢ æ¥å— / ä¿®æ”¹ AI å»ºè®®"
                details="â€¢ Add contextual judgment"
                detailsCn="â€¢ æ·»åŠ æƒ…å¢ƒåˆ¤æ–­"
                extraDetails="â€¢ Decision ownership"
                extraDetailsCn="â€¢ å†³ç­–è´£ä»»å½’å±"
                designNote="Responsibility remains with humans."
                designNoteCn="è´£ä»»å§‹ç»ˆç”±äººç±»æ‰¿æ‹…"
                isImportant={true}
                isCritical={true}
              />

              <ArrowConnector />

              {/* Node 5: Outcome & Review */}
              <WorkflowNode
                icon={<BarChart3 className="w-8 h-8" />}
                iconColor="text-green-600"
                bgColor="bg-green-50"
                borderColor="border-green-200"
                number="5"
                title="Outcome & Post-Decision Review"
                titleCn="ç»“æœä¸å†³ç­–åå¤ç›˜"
                description="â€¢ Actual outcome"
                descriptionCn="â€¢ å®é™…ç»“æœ"
                details="â€¢ Decision effectiveness"
                detailsCn="â€¢ å†³ç­–æœ‰æ•ˆæ€§"
                extraDetails="â€¢ Feedback into analytics"
                extraDetailsCn="â€¢ åé¦ˆè‡³åˆ†æç³»ç»Ÿ"
              />
            </div>
          </div>

          {/* Footer Notes */}
          <div className={`bg-white rounded-lg border-2 border-slate-200 shadow-sm ${screenshotMode ? 'mt-4 p-3' : 'mt-12 p-6'}`}>
            <h3 className={`font-semibold text-slate-900 ${screenshotMode ? 'mb-2 text-sm' : 'mb-3'}`}>æ ¸å¿ƒè®¾è®¡åŸåˆ™ (Core Design Principles)</h3>
            <div className={`grid md:grid-cols-2 gap-4 text-slate-700 ${screenshotMode ? 'text-xs' : 'text-sm'}`}>
              <div className="flex items-start gap-2">
                <span className="text-blue-600 mt-1">â€¢</span>
                <span><strong>AI as Advisor:</strong> AI æä¾›é€‰é¡¹å’Œåˆ†æï¼Œè€Œéåšå‡ºæœ€ç»ˆå†³ç­–</span>
              </div>
              <div className="flex items-start gap-2">
                <span className="text-purple-600 mt-1">â€¢</span>
                <span><strong>Human Authority:</strong> äººç±»ä¿ç•™æœ€ç»ˆå†³ç­–æƒå’Œè´£ä»»</span>
              </div>
              <div className="flex items-start gap-2">
                <span className="text-orange-600 mt-1">â€¢</span>
                <span><strong>Time-Critical Design:</strong> ä¸ºé«˜å‹ç¯å¢ƒä¸‹çš„å¿«é€Ÿå†³ç­–ä¼˜åŒ–</span>
              </div>
              <div className="flex items-start gap-2">
                <span className="text-green-600 mt-1">â€¢</span>
                <span><strong>Continuous Learning:</strong> é€šè¿‡åé¦ˆå¾ªç¯æŒç»­æ”¹è¿›</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

interface WorkflowNodeProps {
  icon: React.ReactNode;
  iconColor: string;
  bgColor: string;
  borderColor: string;
  number: string;
  title: string;
  titleCn: string;
  description: string;
  descriptionCn: string;
  details?: string;
  detailsCn?: string;
  extraDetails?: string;
  extraDetailsCn?: string;
  designNote?: string;
  designNoteCn?: string;
  isImportant?: boolean;
  isCritical?: boolean;
  screenshotMode?: boolean;
}

function WorkflowNode({
  icon,
  iconColor,
  bgColor,
  borderColor,
  number,
  title,
  titleCn,
  description,
  descriptionCn,
  details,
  detailsCn,
  extraDetails,
  extraDetailsCn,
  designNote,
  designNoteCn,
  isImportant,
  isCritical
}: WorkflowNodeProps) {
  return (
    <div className="relative">
      <div className={`bg-white rounded-xl p-6 border-2 ${borderColor} shadow-lg hover:shadow-xl transition-shadow h-full flex flex-col`}>
        {/* Number Badge */}
        <div className={`absolute -top-3 -left-3 w-8 h-8 ${bgColor} ${borderColor} border-2 rounded-full flex items-center justify-center font-bold text-sm ${iconColor}`}>
          {number}
        </div>

        {/* Icon */}
        <div className={`${bgColor} w-16 h-16 rounded-lg flex items-center justify-center mb-4 ${iconColor}`}>
          {icon}
        </div>

        {/* Title */}
        <h3 className="font-bold text-lg text-slate-900 mb-1">{title}</h3>
        <p className="text-sm text-slate-600 mb-4">{titleCn}</p>

        {/* Description */}
        <div className="text-sm text-slate-700 space-y-1 flex-grow">
          <p>{description}</p>
          <p className="text-xs text-slate-500">{descriptionCn}</p>
          
          {details && (
            <>
              <p className="mt-2">{details}</p>
              <p className="text-xs text-slate-500">{detailsCn}</p>
            </>
          )}
          
          {extraDetails && (
            <>
              <p className="mt-2">{extraDetails}</p>
              <p className="text-xs text-slate-500">{extraDetailsCn}</p>
            </>
          )}
        </div>

        {/* Design Note */}
        {designNote && (
          <div className={`mt-4 pt-4 border-t-2 ${borderColor}`}>
            <p className={`text-xs font-semibold ${isImportant ? 'text-slate-900' : 'text-slate-700'} ${isCritical ? 'text-purple-900' : ''}`}>
              {isCritical && 'â­ '}
              {isImportant && !isCritical && 'ğŸ’¡ '}
              PM è§†è§’ï¼š{designNote}
            </p>
            <p className="text-xs text-slate-500 mt-1">{designNoteCn}</p>
          </div>
        )}
      </div>
    </div>
  );
}

function ArrowConnector() {
  return (
    <div className="hidden lg:flex items-center justify-center">
      <ArrowRight className="w-8 h-8 text-slate-400" />
    </div>
  );
}
